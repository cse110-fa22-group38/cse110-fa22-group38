<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: database.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: database.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * importing express object
 */
const express = require('express');
/**
 * initializing app
 */
const app = express();
/**
 * importing sqlite 3 to js file
 */
const sqlite3 = require('sqlite3').verbose();
/** use md 5 to encrypt */
const md5 = require('md5');

/**
 *  usertable to hold user data
 */
let usersTable =
    `
CREATE TABLE IF NOT EXISTS users (
  username type UNIQUE,
  password_hash,
  api_token)
`;


/**
 * eventTable to hold events
 */
let eventTable =
    `
CREATE TABLE IF NOT EXISTS events (
  username,
  event_id,
  event_type,
  event_name,
  event_relation,
  event_location,
  event_details,
  event_start datetime,
  event_end datetime,
  event_completed boolean,
  event_color)
`;

/**
 * insertNew User query
 */
let insertNewUser =
    `
INSERT INTO users (
  username,
  password_hash,
  api_token) VALUES (?,?,?,?)
`;

/** source of db */
const DBSOURCE = "./database/user.sqlite";

/**actual db */
let db = new sqlite3.Database(DBSOURCE,
    sqlite3.OPEN_READWRITE | sqlite3.OPEN_CREATE, (err) => {
        if (err) {
            console.log(err);
            throw (err);
        } else {
            console.log("database.js: Connected to DB")
            db.run(usersTable, (err) => {
                if (err) {
                    // Table already created
                } else {
                    // Table just created, creating a dummy user
                }
            });

            db.run(eventTable, (err) => {
                if (err) {
                    // Table already created
                }
            });
        }
    })

// Exporting our db via module, ready for use 
module.exports = db;

// Example of a dataentry object
var dataentry = {
    "username": "Tung",
    "event_id": "dataentryID",
    "event_type": "event",
    "event_name": "class 100a",
    "event_relation": "class 100a",
    "event_location": "9500 Gilman Drive",
    "event_details": "description",
    "event_start": "yyyy-mm-ddThh:mm:00Z",
    "event_end": "yyyy-mm-ddThh:mm:00Z",
    "event_completed": Boolean(false),
    "event_color": "#ffffff"
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#DBSOURCE">DBSOURCE</a></li><li><a href="global.html#INSERT">INSERT</a></li><li><a href="global.html#PORT">PORT</a></li><li><a href="global.html#REGULAR_EVENT">REGULAR_EVENT</a></li><li><a href="global.html#SPECIAL_EVENT">SPECIAL_EVENT</a></li><li><a href="global.html#TASK">TASK</a></li><li><a href="global.html#activeCourses">activeCourses</a></li><li><a href="global.html#apiToken">apiToken</a></li><li><a href="global.html#app">app</a></li><li><a href="global.html#bcrypt">bcrypt</a></li><li><a href="global.html#bodyParser">bodyParser</a></li><li><a href="global.html#colors">colors</a></li><li><a href="global.html#db">db</a></li><li><a href="global.html#eventTable">eventTable</a></li><li><a href="global.html#express">express</a></li><li><a href="global.html#fetch">fetch</a></li><li><a href="global.html#flash">flash</a></li><li><a href="global.html#getCurrentCourses">getCurrentCourses</a></li><li><a href="global.html#getICStexts">getICStexts</a></li><li><a href="global.html#grabFromCanvas">grabFromCanvas</a></li><li><a href="global.html#ical">ical</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#initializePassport">initializePassport</a></li><li><a href="global.html#insertNewUser">insertNewUser</a></li><li><a href="global.html#isSpecialEvent">isSpecialEvent</a></li><li><a href="global.html#logged_user">logged_user</a></li><li><a href="global.html#md5">md5</a></li><li><a href="global.html#methodOverride">methodOverride</a></li><li><a href="global.html#passport">passport</a></li><li><a href="global.html#path">path</a></li><li><a href="global.html#session">session</a></li><li><a href="global.html#sqlite3">sqlite3</a></li><li><a href="global.html#users">users</a></li><li><a href="global.html#usersTable">usersTable</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Thu Dec 01 2022 11:33:24 GMT-0800 (北美太平洋标准时间)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
